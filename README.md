
```text
   ______  ____ _      __
  / __/ / / __ | | /| / /
 _\ \/ /_/ /_/ | |/ |/ / 
/___/____\____/|__/|__/    SPOTLIGHT Lag Of Wavefronts
```
                             
## **SPOTLIGHT Lag Of Wavefronts**
**Estimating the burst arrival time offset between SPOTLIGHT’s Beam data and Visibility data**

Repository for details of burst ToA offset estimation experiment.  
Check the Final Report [here](./Final_Report.pdf)  
~ Raghav Wani, August 2025

### Essential Scripts:

* `make_pc_beam.py`\
 Python script developed by Arpan to make PC beam from visibility raw data. It stores PC beam data in dat file.\
	*Usage*:
	```bash
	python3 make_pc_beam.py -f Visi-R*.raw \
		--freq-start 550e6 --freq-end 750e6 \
		--channels 4096 --output 30ant.dat \
		--antmask 0x738ffff --no-bandpass --no-baseline

* `dat_to_beam.py` \
 Python script to convert dat file generated by make_pc_beam.py into a filterbank file.\
	*Usage*:\
	`python dat_to_beam.py` then enter input details

* `presto_timeseries.py`\
 Python script to plot de-dispersed timeseries from dat file and estimate burst toa offset, for comparing visibility and beam data. \
	*Usage*: \
	`python presto_timeseries.py` then enter input details

* `gwb_vs_splt_presto_timeseries.py`
 Python script to plot de-dispersed timeseries from dat file and estimate burst toa offset, mainly for comparing burst profiles from GWB with SPOTLIGHT beam data.\
	*Usage*:\
	`python gwb_vs_splt_presto_timeseries.py` then enter input details

### File structure of `.dat` file made from raw visibility data
**Header (44 bytes):**
- 5 doubles → (freq_start, freq_end, channel_width, integration_time, processing_timestamp)  
- 1 integer → channels  

**Data Records:**
- 8-byte timestamp (double, Unix time with μs precision)  
- 4096 × 4-byte floats → beam power data  
- Each record = 1.31072 ms integrated beam data (550–750 MHz, 4096 channels).  


### Supporting Tools
* Raw data from filterbank file
	```bash
	dd if=BM24.fil of=BM24.hdr bs=1 count=345 # Makes header file 
	dd if=BM24.fil of=BM24.raw bs=1M skip=345 iflag=skip_bytes # Makes raw file

* Re-scaling the raw data:
	```bash
	./read_PAbeam.8bit.PC_beam.noscale.offset <input data file name> \
      <output file name> <observation duration in seconds> \
      <Frequency channel> <input time resolution in sec> \
      <integration factor for PA beam> <scaling factor>
  	
Example: `./read_PAbeam.8bit.PC_beam.noscale.offset BM7.raw BM7_offset64.raw 550 4096 0.00131072 1 64`

* Making filterbank after re-scaling
	```bash
	cat BM7.hdr BM7_offset64.raw > BM7_offset64.fil